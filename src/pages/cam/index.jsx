import React from 'react'
import { connect, NavLink } from 'umi'
import { Divider, Tag, Card, Tooltip, Row, Col } from 'antd'
import store from 'store'
import GridCard from 'components/GridCard'
import styles from './index.less'

const Cam = ({
  cam,
  mainTagList,
  tagList,
  recommend,
  dispatch
}) => {

  const handleClick = (type, val) => {
    const user = store.get('user')
    switch(type){
      case 'like':
        dispatch({
          type: 'cam/setLike',
          payload: {
            like: val,
            cid: cam.id,
            uid: user.id
          }
        })
        break
      case 'disLike':
        dispatch({
          type: 'cam/setDisLike',
          payload: {
            disLike: val,
            cid: cam.id,
            uid: user.id
          }
        })
        break
      case 'collect':
        dispatch({
          type: 'cam/setCollect',
          payload: {
            collect: val,
            cid: cam.id,
            uid: user.id
          }
        })
        break
      default:
        break
    }
  }

  return (
    <>
      <Card className={styles.wrpper}>
        <h1>{cam.tit.replace('era', '摄像头')}</h1>
        <Divider />
        <div className={styles.addrWrapper}>
          <div>
            <NavLink to={`/home?country=${cam.country}`}>
              <Tooltip placement='top' title='国家'>
                <Tag color="red">{cam.country}</Tag>
              </Tooltip>
            </NavLink>
            {cam.state && (
              <NavLink to={`/home?state=${cam.state}`}>
                <Tooltip placement='top' title='地区'>
                  <Tag color="green">{cam.state}</Tag>
                </Tooltip>
              </NavLink>
            )}
            <NavLink to={`/home?city=${cam.city}`}>
              <Tooltip placement='top' title='城市'>
                <Tag color="cyan">{cam.city}</Tag>
              </Tooltip>
            </NavLink>
          </div>
          <div>
            <Tooltip placement="top" title='资源原地址'>
              <a href={cam.origin} target='_blank' rel="noreferrer">{cam.origin.replace(/.*www.(.*).com.*/, '$1').toUpperCase()}</a>
            </Tooltip>
          </div>
        </div>
      </Card>
      <Card className={styles.camWrapper}>
        <div className={styles.cam}>
          <iframe width='900' height='500' src={cam.source} title=' ' frameborder="0"></iframe>
        </div>
        <div >
          <div style={{
            margin: 10
          }} className={styles.icons}>
            <div>
              <NavLink to={`/home?mainTag=${cam.mainTag}`} style={{
                textIndent: 0
              }}>
                <Tag color='#87d068'>{mainTagList.find(item => item.id === cam.mainTag).name}</Tag>
              </NavLink>
              {cam.tag.map(i => (
                <NavLink to={`/home?tag=${i}`} style={{
                  textIndent: 0
                }}>
                  <Tag color='orange'>{tagList.find(item => item.id === i).name}</Tag>
                </NavLink>
              ))}
            </div>
            <div className={styles.right}>
              <span>
                <i onClick={() => handleClick('like', !cam.isLike)}>
                  <Tooltip placement='top' title={`${cam.isLike ? '取消' : ''}喜欢`}>
                    {!cam.isLike ? (
                      <svg t="1684123917918" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8622" width="20" height="20"><path d="M743.328 985.536H426.624c-12.896 0-23.392-10.368-23.392-23.104s10.496-23.072 23.392-23.072h316.704c67.296 0 99.808-36.512 115.168-67.136 0.768-1.856 1.024-3.552 1.408-5.568 2.912-14.624 7.84-39.168 40.192-77.92 23.328-27.968 19.328-57.664 14.624-92.032-1.472-10.912-2.944-21.76-3.552-32.512-2.688-45.856 9.344-65.664 26.048-93.12a686.127 686.127 0 0 0 9.792-16.32c15.328-26.432 14.464-59.232-2.304-87.712-20.48-34.816-59.008-55.648-103.008-55.648-77.952 0-167.808 2.656-168.672 2.656-7.776 0.288-13.888-2.72-18.464-8-4.64-5.28-6.528-12.352-5.28-19.2 0.32-1.6 29.664-160.48 29.664-230.304 0-71.616-54.336-79.328-77.632-79.328-36.832 0-66.784 39.2-66.784 87.424 0 59.936 0 80.16-31.68 123.904-43.712 60.352-126.24 161.632-188.416 161.632H275.04V962.4c0 12.768-10.496 23.104-23.392 23.104H117.76c-49.056 0-88.992-39.392-88.992-87.808V491.808c0-48.384 39.904-87.776 88.992-87.776h196.704c27.84 0 89.696-58.496 150.304-142.272 22.976-31.712 22.976-39.168 22.976-97.088 0-74.944 49.856-133.6 113.536-133.6 57.408 0 124.448 32.896 124.448 125.504 0 56.128-16.8 160.576-25.44 210.656 33.184-0.8 89.856-1.952 141.408-1.952 60.864 0 114.56 29.376 143.488 78.624 25.216 42.88 26.144 92.928 2.464 133.792-3.68 6.336-7.104 11.968-10.272 17.184-15.52 25.472-21.344 35.008-19.488 66.656 0.576 9.568 1.952 19.296 3.232 29.024 5.088 37.408 11.424 83.968-24.896 127.488-24.832 29.792-28.192 46.496-30.432 57.536-1.056 5.28-2.176 10.752-4.928 16.256-30.528 60.704-86.304 93.696-157.536 93.696zM117.76 450.208c-23.232 0-42.176 18.656-42.176 41.6V897.76c0 22.976 18.944 41.632 42.176 41.632h110.496V450.208H117.76z m0 0" fill="#333333" p-id="8623"></path></svg>
                    ) : (
                      <svg t="1684123924581" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8758" width="20" height="20"><path d="M229.248 416.704H96.192a64.16 64.16 0 0 0-63.904 69.76l-0.032-0.224 37.376 447.008a64.192 64.192 0 0 0 63.904 58.816h95.68c17.728 0 32.064-14.368 32.064-32.064V448.864c0-17.728-14.368-32.064-32.064-32.096z m696.928 0h-287.072C737.888 50.752 570.432 32 570.432 32c-71.04 0-56.32 56.256-61.664 65.6 0 135.84-109.12 249.28-162.112 296.352a63.552 63.552 0 0 0-21.184 47.424v518.592c0 17.728 14.368 32.064 32.064 32.064H732.672a128.128 128.128 0 0 0 114.496-70.56l0.352-0.736c29.184-59.072 64.96-144.864 87.744-215.296 22.048-68.16 42.112-152.704 53.856-212.16a64.096 64.096 0 0 0-62.88-76.544h-0.064z" p-id="8759"></path></svg>
                    )}
                  </Tooltip>
                </i>
                <span className={styles.count}>
                  {cam.likenum}
                </span>
              </span>
              <span>
                <i onClick={() => handleClick('disLike', !cam.isDisLike)}>
                <Tooltip placement='top' title={`${cam.isDisLike ? '取消' : ''}不喜欢`}>
                  {!cam.isDisLike ? (
                    <svg t="1684123943174" class="icon" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9774" width="20" height="20"><path d="M113.917481 512.118771" fill="#272536" p-id="9775"></path><path d="M627.718496 271.290703" fill="#272536" p-id="9776"></path><path d="M234.579295 638.975091c62.890108 0 122.720847 25.55413 168.470091 68.658678 45.556754 42.923321 72.815653 100.847585 76.754539 163.101861l0 0c0.967572 46.833539 39.923337 84.62105 87.299534 84.62105 43.339018 0 79.727902-31.877646 85.623434-74.522469 0.133105-0.647096 0.24778-1.302382 0.329691-1.969955 2.197258-17.938471 2.343674-42.35916 2.348793-43.389188 0-0.040955 0-0.081911 0-0.122866 0-49.669701-10.141584-97.699138-30.141136-142.753164-11.487993-25.878702-25.897132-50.003488-43.02059-72.181868l316.727663 0c20.325148 0 36.859872-16.534724 36.859872-36.859872 0-1.395556-0.119795-2.78804-0.355288-4.164142L852.802278 98.59299c-1.358696-19.096485-17.329259-34.217224-36.765674-34.217224L223.824404 64.375766l-43.718879 0-65.31774 0c-20.325148 0-36.859872 16.534724-36.859872 36.859872l0 500.653303c0 20.325148 16.534724 36.859872 36.859872 36.859872l109.037644 0M211.53778 113.522262l0 476.080055-84.463372 0L127.074408 113.522262l53.03214 0 31.432256 0L211.53778 113.522262zM884.212008 571.274769 526.790024 571.274769c-0.014334 0-0.029693-0.002048-0.044027-0.002048-0.833443 0-1.665861 0.043003-2.495209 0.126962-0.220135 0.022525-0.436175 0.054266-0.654263 0.081911-0.185323 0.023549-0.369623 0.043003-0.553922 0.070648-0.362455 0.054266-0.719791 0.119795-1.076103 0.189419-0.041979 0.008191-0.083959 0.014334-0.125938 0.022525-1.221495 0.246756-2.410226 0.583615-3.558002 1.004432-0.222183 0.081911-0.441295 0.173037-0.66143 0.261091-0.151535 0.060409-0.305118 0.116723-0.455629 0.180204-0.302046 0.126962-0.599997 0.265186-0.897947 0.405459-0.064505 0.029693-0.131057 0.057338-0.194538 0.088054-0.304094 0.146416-0.605116 0.30307-0.904091 0.462796-0.054266 0.028669-0.109556 0.05529-0.162798 0.083959-0.287712 0.155631-0.571328 0.3215-0.85392 0.490441-0.063481 0.037884-0.127986 0.07372-0.191467 0.112627-0.264162 0.16075-0.524229 0.330715-0.784296 0.502728-0.079863 0.052218-0.16075 0.104436-0.239589 0.157678-0.239589 0.162798-0.474059 0.331739-0.708529 0.503752-0.099317 0.072696-0.198634 0.144368-0.295903 0.218088-0.211944 0.16075-0.419793 0.325596-0.627642 0.493513-0.119795 0.096245-0.239589 0.193514-0.357336 0.292831-0.182252 0.153583-0.363479 0.310237-0.542659 0.469963-0.14232 0.126962-0.282592 0.254947-0.421841 0.384981-0.153583 0.144368-0.307166 0.288736-0.457677 0.437199-0.161774 0.159726-0.3215 0.323548-0.479178 0.487369-0.089078 0.09215-0.182252 0.180204-0.270306 0.274401-0.022525 0.024573-0.041979 0.052218-0.064505 0.076791-0.518086 0.559041-1.009551 1.142656-1.474395 1.747772-0.039932 0.051194-0.081911 0.101365-0.120818 0.153583-0.460748 0.610236-0.891804 1.242997-1.295215 1.895212-0.025597 0.041979-0.054266 0.082935-0.079863 0.124914-0.404435 0.663478-0.778153 1.349481-1.120131 2.05289-0.009215 0.019454-0.020478 0.038908-0.029693 0.058361-1.015694 2.105108-1.73651 4.379158-2.116371 6.766858-0.002048 0.013311-0.005119 0.026621-0.007167 0.039932-0.114675 0.729006-0.193514 1.469275-0.242661 2.218759-0.004096 0.059385-0.010239 0.119795-0.013311 0.17918-0.027645 0.481226-0.046075 0.9645-0.046075 1.452893 0 0.233446 0.011263 0.46382 0.017406 0.696242 0.002048 0.081911 0.003072 0.162798 0.006143 0.244709 0.027645 0.726959 0.088054 1.445726 0.177132 2.155279 0.007167 0.059385 0.014334 0.117747 0.022525 0.177132 0.098293 0.738221 0.22935 1.466204 0.392148 2.1819 0.009215 0.041979 0.019454 0.082935 0.028669 0.12389 0.169965 0.731054 0.37167 1.449822 0.605116 2.154255 0.015358 0.047099 0.03174 0.093174 0.047099 0.140272 0.235494 0.699314 0.501704 1.384293 0.797607 2.05289 0.030717 0.0686 0.062457 0.136177 0.093174 0.204777 0.295903 0.652215 0.618427 1.289072 0.967572 1.909546 0.049146 0.08703 0.099317 0.173037 0.149487 0.260067 0.354264 0.61126 0.733102 1.206137 1.137537 1.782584 0.059385 0.084982 0.119795 0.169965 0.181228 0.254947 0.424912 0.589758 0.874398 1.159038 1.348457 1.707841 0.054266 0.062457 0.107508 0.124914 0.161774 0.186347 0.511943 0.581567 1.050506 1.137537 1.614667 1.667909 0.019454 0.01843 0.03686 0.039932 0.057338 0.059385 30.078679 28.079031 53.756027 61.298991 70.373686 98.734286 17.187963 38.7172 25.905323 80.01459 25.914538 122.749516-0.008191 1.293167-0.186347 22.924792-1.98429 37.601165-0.008191 0.067576-0.011263 0.134129-0.019454 0.201705l-0.060409-0.007167c-2.097941 18.885565-18.042907 33.126786-37.09127 33.126786-20.880093 0-38.250308-18.01731-38.250308-38.577951l-20.408082 1.291119 20.408082-1.291119c-4.729326-74.739533-37.437343-144.265442-92.100533-195.768922-48.532164-45.725695-110.268354-73.276401-176.06732-79.059305l0-479.280721 544.816549 0L884.212008 571.274769z" fill="#272536" p-id="9777"></path></svg>
                  ) : (
                    <svg t="1684123954469" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9916" width="20" height="20"><path d="M591.62819 902.095238c7.68 0 21.187048-1.633524 31.524572-4.973714 50.907429-16.481524 80.213333-70.582857 68.339809-124.684191l-1.219047-5.071238-45.372953-170.203428h179.736381c21.820952 0 43.398095-8.070095 58.026667-24.283429a74.118095 74.118095 0 0 0 17.846857-65.267809l-1.219047-4.973715-94.768762-337.432381a59.294476 59.294476 0 0 0-52.662857-43.154285L747.471238 121.904762H268.190476V580.022857c97.084952 21.016381 239.079619 279.28381 239.079619 279.28381 20.187429 27.40419 44.665905 42.812952 84.358095 42.812952zM121.904762 585.142857h73.142857V121.904762H121.904762z" p-id="9917"></path></svg>
                  )}
                </Tooltip>
                </i>
                <span className={styles.count}>
                  {cam.dislikenum}
                </span>
              </span>
              <span>
                <i onClick={() => handleClick('collect', !cam.isCollect)}>
                <Tooltip placement='top' title={`${cam.isCollect ? '取消' : ''}收藏`}>
                  {cam.isCollect ? (
                    <svg t="1684123813362" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2511" width="20" height="20"><path d="M512.009505 25.054894l158.199417 320.580987 353.791078 51.421464L767.995248 646.579761l60.432101 352.365345-316.417844-166.354615-316.436854 166.354615 60.432101-352.365345L0 397.057345l353.791078-51.421464z" fill="#EFCE4A" p-id="2512"></path></svg>
                  ) : (
                    <svg t="1684123826764" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2651" width="20" height="20"><path d="M512.810667 64h-0.064a32 32 0 0 0-28.928 18.325333l-121.856 258.026667-270.72 40.810667a32 32 0 0 0-18.197334 53.909333l196.437334 202.090667-46.890667 284.778666a32.021333 32.021333 0 0 0 47.018667 33.258667l241.834666-133.013333 241.301334 133.845333c4.842667 2.624 10.176 3.968 15.530666 3.968h0.64c17.706667 0 32-14.293333 32-32 0-3.968-0.704-7.765333-2.026666-11.285333l-44.885334-278.698667 196.928-201.237333c8.32-8.554667 11.221333-21.098667 7.466667-32.448a32.064 32.064 0 0 0-25.536-21.525334l-270.293333-41.728-120.832-258.602666A32 32 0 0 0 512.810667 64m-0.213334 107.285333l91.946667 196.885334a64.064 64.064 0 0 0 48.234667 36.181333l208.810666 32.213333-153.344 156.693334a64 64 0 0 0-17.429333 54.933333l35.434667 219.946667-183.765334-101.930667a64 64 0 0 0-61.866666-0.106667l-184.170667 101.290667 36.181333-219.84a63.978667 63.978667 0 0 0-17.258666-55.018667l-153.002667-157.376 209.130667-31.530666a63.957333 63.957333 0 0 0 48.341333-35.946667l92.757333-196.394667" fill="#000000" p-id="2652"></path></svg>
                  )}
                </Tooltip>
                </i>
                <span className={styles.count}>
                  {cam.collectnum}
                </span>
              </span>
            </div>
          </div>
          <div className={styles.desc}>
            {cam.desc}
          </div>
        </div>
      </Card>
      <Card>
        <div className='block-box'>更多推荐</div>
        <Row>
          {recommend.map(i => (
            <Col span={12}>
              <GridCard cam={i} mainTagList={mainTagList} tagList={tagList} dispatch={dispatch} />
            </Col>
          ))}
        </Row>
      </Card>
    </>
  )
}
export default connect(({ cam, app, dispatch }) => ({ recommend: cam.recommend, cam: cam.cam, mainTagList: app.mainTagList, tagList: app.tagList, dispatch }))(Cam)